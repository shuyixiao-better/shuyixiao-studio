---
layout: doc
title: TorchV Unstructuredï¼šå¼ºå¤§çš„æ–‡æ¡£è§£æåº“
description: '> ä¸“ä¸º RAG åº”ç”¨ä¼˜åŒ–çš„ Java æ–‡æ¡£è§£æåº“ï¼ŒåŸºäº Apache Tikaã€Apache POI å’Œ PDFBoxï¼Œæä¾›æ™ºèƒ½è¡¨æ ¼ç»“æ„è¯†åˆ«å’Œå†…å®¹æå–èƒ½åŠ›ã€‚'
date: '2025-01-27'
tags:
  - Java
  - æ–‡æ¡£è§£æ
  - RAG
  - Apache Tika
author: èˆ’ä¸€ç¬‘ä¸ç§ƒå¤´
---

# TorchV Unstructuredï¼šå¼ºå¤§çš„æ–‡æ¡£è§£æåº“

> ä¸“ä¸º RAG åº”ç”¨ä¼˜åŒ–çš„ Java æ–‡æ¡£è§£æåº“ï¼ŒåŸºäº Apache Tikaã€Apache POI å’Œ PDFBoxï¼Œæä¾›æ™ºèƒ½è¡¨æ ¼ç»“æ„è¯†åˆ«å’Œå†…å®¹æå–èƒ½åŠ›ã€‚

## ğŸ“– é¡¹ç›®ç®€ä»‹

**TorchV Unstructured** æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”å¼€å‘è€…å‹å¥½çš„æ–‡æ¡£è§£æåº“ï¼Œä¸“ä¸º RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰åº”ç”¨ä¼˜åŒ–ã€‚è¯¥é¡¹ç›®åŸºäºä¸šç•Œæ ‡å‡†çš„ Java åº“ï¼ˆå¦‚ Apache Tikaã€Apache POI å’Œ PDFBoxï¼‰æ„å»ºï¼Œæä¾›å¢å¼ºçš„è§£æèƒ½åŠ›ï¼ŒåŒ…æ‹¬æ™ºèƒ½è¡¨æ ¼ç»“æ„è¯†åˆ«å’Œå†…å®¹æå–ã€‚

### ğŸ”— é¡¹ç›®é“¾æ¥

- **GitHub**: [https://github.com/torchv/torchv-unstructured](https://github.com/torchv/torchv-unstructured)
- **è®¸å¯è¯**: Apache-2.0 License
- **Maven Central**: `com.torchv.infra:torchv-unstructured:1.0.0`

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### 1. ğŸ§  æ™ºèƒ½è¡¨æ ¼è§£æ

é¡¹ç›®æä¾›å…ˆè¿›çš„è¡¨æ ¼ç»“æ„åˆ†æèƒ½åŠ›ï¼š

- **å•å…ƒæ ¼åˆå¹¶æ£€æµ‹**ï¼šå‡†ç¡®è¯†åˆ«è¡¨æ ¼ä¸­çš„åˆå¹¶å•å…ƒæ ¼
- **ç»“æ„ä¿æŒ**ï¼šå®Œæ•´ä¿ç•™è¡¨æ ¼çš„å±‚æ¬¡ç»“æ„
- **HTML è¡¨æ ¼ç”Ÿæˆ**ï¼šç”Ÿæˆæ¸…æ´çš„ HTML è¡¨æ ¼ä»£ç 
- **Markdown å…¼å®¹**ï¼šæ”¯æŒ Markdown æ ¼å¼çš„è¡¨æ ¼è¾“å‡º

### 2. ğŸ“„ å¤šæ ¼å¼æ”¯æŒ

æ— ç¼å¤„ç†å„ç§æ–‡æ¡£æ ¼å¼ï¼š

- **Word æ–‡æ¡£**ï¼šDOCã€DOCX æ ¼å¼å®Œæ•´æ”¯æŒ
- **PDF æ–‡æ¡£**ï¼šåŸºäº PDFBox çš„ PDF è§£æ
- **å…¶ä»–æ ¼å¼**ï¼šé€šè¿‡ Apache Tika æ”¯æŒæ›´å¤šæ ¼å¼
- **è‡ªåŠ¨æ£€æµ‹**ï¼šæ™ºèƒ½è¯†åˆ«æ–‡ä»¶ç±»å‹

### 3. ğŸ¯ RAG ä¼˜åŒ–è¾“å‡º

ä¸“ä¸º AI/ML ç®¡é“è®¾è®¡ï¼š

- **ç»“æ„åŒ–å†…å®¹**ï¼šæ¸…æ´ã€ç»“æ„åŒ–çš„å†…å®¹æå–
- **å…ƒæ•°æ®ä¸°å¯Œ**ï¼šæå–å…¨é¢çš„æ–‡æ¡£å…ƒæ•°æ®
- **åµŒå…¥å‹å¥½**ï¼šé€‚åˆç”ŸæˆåµŒå…¥å‘é‡çš„æ ¼å¼
- **ä¸Šä¸‹æ–‡ä¿æŒ**ï¼šç»´æŒæ–‡æ¡£çš„è¯­ä¹‰å…³ç³»

### 4. ğŸ–¼ï¸ å›¾åƒå¤„ç†

è‡ªåŠ¨å¤„ç†åµŒå…¥å›¾åƒï¼š

- **å›¾åƒæå–**ï¼šè‡ªåŠ¨æå–æ–‡æ¡£ä¸­çš„å›¾åƒ
- **æ ¼å¼æ”¯æŒ**ï¼šæ”¯æŒå¤šç§å›¾åƒæ ¼å¼
- **è·¯å¾„ç®¡ç†**ï¼šæ™ºèƒ½çš„å›¾åƒè·¯å¾„å¤„ç†

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ ¸å¿ƒç»„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         UnstructuredParser           â”‚
â”‚        (ç»Ÿä¸€å…¥å£ç‚¹)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚             â”‚             â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â–¼â”€â”€â”€â”
â”‚ Word  â”‚    â”‚  PDF    â”‚    â”‚ Other â”‚
â”‚Parser â”‚    â”‚ Parser  â”‚    â”‚Parser â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”¬â”€â”€â”€â”˜
    â”‚             â”‚             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    Content Handlers       â”‚
    â”‚  (Markdown/HTMLè¾“å‡º)       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¸»è¦ç±»ç»“æ„

- **UnstructuredParser**: ä¸»è¦å…¥å£ç±»ï¼Œæä¾›ç®€å•ç»Ÿä¸€çš„ API
- **UnstructuredWord**: é€šç”¨ Word æ–‡æ¡£è§£æå™¨
- **WordTableParser**: ä¸“é—¨çš„ Word è¡¨æ ¼è§£æå™¨
- **TableStructureAnalyzer**: æ™ºèƒ½è¡¨æ ¼ç»“æ„è¯†åˆ«å™¨
- **CellMergeAnalyzer**: é«˜çº§å•å…ƒæ ¼åˆå¹¶æ£€æµ‹å™¨

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€æ–‡æ¡£è§£æ

```java
import com.torchv.infra.unstructured.UnstructuredParser;

// è§£ææ–‡æ¡£ä¸º Markdownï¼ˆæ¨èç”¨äº RAGï¼‰
String content = UnstructuredParser.toMarkdown("document.docx");
System.out.println(content);

// è§£ææ–‡æ¡£ä¸ºå¸¦ HTML è¡¨æ ¼çš„ Markdownï¼ˆä¿ç•™è¡¨æ ¼ç»“æ„ï¼‰
String contentWithTables = UnstructuredParser.toMarkdownWithHtmlTables("document.docx");
System.out.println(contentWithTables);
```

### é«˜çº§è¡¨æ ¼æå–

```java
import com.torchv.infra.unstructured.UnstructuredParser;
import java.util.List;

// ä»…æå– Word æ–‡æ¡£ä¸­çš„è¡¨æ ¼
List<String> tables = UnstructuredParser.extractTables("document.docx");
for (int i = 0; i < tables.size(); i++) {
    System.out.println("Table " + (i + 1) + ":");
    System.out.println(tables.get(i));
}

// è·å–ç»“æ„åŒ–ç»“æœï¼Œæ›´å¤šæ§åˆ¶
DocumentResult result = UnstructuredParser.toStructuredResult("document.docx");
if (result.isSuccess()) {
    System.out.println("Content: " + result.getContent());
    System.out.println("Tables: " + result.getTables());
}
```

### RAG åº”ç”¨é›†æˆ

```java
public class RAGDocumentProcessor {
    
    public DocumentChunk processDocument(String filePath) {
        // è§£æå¹¶ä¿ç•™è¡¨æ ¼ç»“æ„ï¼Œä¾¿äºæ›´å¥½çš„ä¸Šä¸‹æ–‡ç†è§£
        String content = UnstructuredParser.toMarkdownWithHtmlTables(filePath);
        
        // å•ç‹¬æå–è¡¨æ ¼ç”¨äºç»“æ„åŒ–æ•°æ®å¤„ç†
        List<String> tables = UnstructuredParser.extractTables(filePath);
        
        return new DocumentChunk(content, tables);
    }
}
```

### æ‰¹é‡å¤„ç†

```java
public class BatchProcessor {
    
    public void processBatch(List<String> filePaths) {
        filePaths.parallelStream()
                .filter(UnstructuredUtils::isSupportedFormat)
                .forEach(this::processFile);
    }
    
    private void processFile(String filePath) {
        try {
            String content = UnstructuredParser.toMarkdownWithHtmlTables(filePath);
            // ä¿å­˜æˆ–è¿›ä¸€æ­¥å¤„ç†å†…å®¹
            saveProcessedContent(filePath, content);
        } catch (Exception e) {
            log.error("Failed to process file: {}", filePath, e);
        }
    }
}
```

## ğŸ¯ åº”ç”¨åœºæ™¯

### RAG ç³»ç»Ÿ

- **æ–‡æ¡£é¢„å¤„ç†**ï¼šå°†å„ç§æ ¼å¼çš„æ–‡æ¡£è½¬æ¢ä¸ºé€‚åˆåµŒå…¥çš„æ ¼å¼
- **è¡¨æ ¼æ•°æ®æå–**ï¼šä¿æŒè¡¨æ ¼ç»“æ„ï¼Œä¾¿äº AI ç†è§£
- **æ‰¹é‡æ–‡æ¡£å¤„ç†**ï¼šé«˜æ•ˆå¤„ç†å¤§é‡æ–‡æ¡£

### å†…å®¹ç®¡ç†ç³»ç»Ÿ

- **æ–‡æ¡£è½¬æ¢**ï¼šå°† Word/PDF è½¬æ¢ä¸º Web å‹å¥½çš„æ ¼å¼
- **å†…å®¹æå–**ï¼šæå–æ–‡æ¡£ä¸­çš„ç»“æ„åŒ–ä¿¡æ¯
- **æ ¼å¼æ ‡å‡†åŒ–**ï¼šç»Ÿä¸€ä¸åŒæ¥æºçš„æ–‡æ¡£æ ¼å¼

### æ•°æ®åˆ†æ

- **è¡¨æ ¼æ•°æ®æå–**ï¼šä»æ–‡æ¡£ä¸­æå–è¡¨æ ¼æ•°æ®è¿›è¡Œåˆ†æ
- **ç»“æ„åŒ–ä¿¡æ¯**ï¼šå°†éç»“æ„åŒ–æ–‡æ¡£è½¬æ¢ä¸ºç»“æ„åŒ–æ•°æ®
- **æ‰¹é‡å¤„ç†**ï¼šå¤„ç†å¤§é‡æ–‡æ¡£è¿›è¡Œæ•°æ®åˆ†æ

## ğŸŒŸ æŠ€æœ¯ä¼˜åŠ¿

### æ€§èƒ½ä¼˜åŒ–

- **å†…å­˜é«˜æ•ˆ**ï¼šæµå¼å¤„ç†å¤§æ–‡æ¡£ï¼Œæœ€å°å†…å­˜å ç”¨
- **å¿«é€Ÿå¤„ç†**ï¼šä¼˜åŒ–çš„ç®—æ³•ï¼Œå¿«é€Ÿè§£æ
- **å¯æ‰©å±•æ€§**ï¼šè®¾è®¡ç”¨äºé«˜ååé‡æ–‡æ¡£å¤„ç†

### å¼€å‘å‹å¥½

- **ç®€å• API**ï¼šç›´è§‚çš„æ¥å£ï¼Œåˆç†çš„é»˜è®¤å€¼
- **å¯æ‰©å±•**ï¼šåŸºäºæ’ä»¶çš„æ¶æ„ï¼Œæ”¯æŒè‡ªå®šä¹‰å†…å®¹å¤„ç†å™¨
- **ç”Ÿäº§å°±ç»ª**ï¼šç»è¿‡å®æˆ˜æµ‹è¯•ï¼Œå…¨é¢çš„é”™è¯¯å¤„ç†

### è´¨é‡ä¿è¯

- **åŸºäºæ ‡å‡†**ï¼šåŸºäº Apache Tikaã€Apache POI ç­‰æˆç†Ÿåº“
- **æµ‹è¯•è¦†ç›–**ï¼šå…¨é¢çš„æµ‹è¯•è¦†ç›–
- **æŒç»­ç»´æŠ¤**ï¼šæ´»è·ƒçš„å¼€å‘å’Œç»´æŠ¤

## ğŸ“š å­¦ä¹ èµ„æº

- **API æ–‡æ¡£**ï¼šè¯¦ç»†çš„ API å‚è€ƒæ–‡æ¡£
- **ç¤ºä¾‹ä»£ç **ï¼šä¸°å¯Œçš„ä½¿ç”¨ç¤ºä¾‹
- **æœ€ä½³å®è·µ**ï¼šRAG åº”ç”¨çš„æœ€ä½³å®è·µæŒ‡å—

## ğŸ¤ è´¡çŒ®ä¸æ”¯æŒ

### è´¡çŒ®æ–¹å¼

1. Fork ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. åˆ›å»º Pull Request

### è”ç³»æ–¹å¼

- ğŸ“§ **é‚®ç®±**: xiaoymin@foxmail.com
- ğŸ› **é—®é¢˜åé¦ˆ**: [GitHub Issues](https://github.com/torchv/torchv-unstructured/issues)
- ğŸ’¬ **è®¨è®ºäº¤æµ**: [GitHub Discussions](https://github.com/torchv/torchv-unstructured/discussions)

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®çš„æ”¯æŒï¼š

- **Apache Tika** - å†…å®¹åˆ†æå·¥å…·åŒ…
- **Apache POI** - Microsoft æ–‡æ¡£ Java API
- **PDFBox** - PDF æ–‡æ¡£æ“ä½œåº“

---

**TorchV Unstructured** æ˜¯ TorchV å›¢é˜Ÿç”¨å¿ƒæ‰“é€ çš„å¼€æºé¡¹ç›®ï¼Œæ—¨åœ¨ä¸º RAG åº”ç”¨æä¾›æœ€ä½³çš„æ–‡æ¡£è§£æè§£å†³æ–¹æ¡ˆã€‚æ— è®ºæ˜¯ä¸ªäººé¡¹ç›®è¿˜æ˜¯ä¼ä¸šåº”ç”¨ï¼Œéƒ½èƒ½ä»ä¸­å—ç›Šã€‚

Made with â¤ï¸ by TorchV Team
