# ESä¸­åœ¨æ˜ å°„ä¸­å®šä¹‰åˆ†è¯å™¨æ•…äº‹ç‰ˆ

> # åœ¨æ˜ å°„ä¸­å®šä¹‰åˆ†è¯å™¨
>
> ## è¯­æ³•
>
> ```
> PUT {index}
> {
>   "mappings": {
>     "properties": {
>       "title":{
>         "type": "text",
>         "analyzer": "{analyzer}"
>       }
>     }
>   }
> }
> ```
>
> ## å†…ç½®åˆ†è¯å™¨
>
> * **Standard Analyzerï¼ˆæ ‡å‡†åˆ†æå™¨ï¼‰** ï¼šæ ‡å‡†åˆ†æå™¨æ˜¯ ES é»˜è®¤çš„åˆ†æå™¨ï¼Œå®ƒä½¿ç”¨ Unicode æ–‡æœ¬åˆ†å‰²ç®—æ³•å°†æ–‡æœ¬åˆ†å‰²æˆå•ä¸ªè¯æ±‡å•å…ƒã€‚å®ƒä¼šå»é™¤æ ‡ç‚¹ç¬¦å·å’Œç©ºæ ¼ï¼Œå¹¶å°†æ–‡æœ¬è½¬æ¢ä¸ºå°å†™å½¢å¼ã€‚ä¾‹å¦‚ï¼Œå°†è¾“å…¥æ–‡æœ¬ "Hello, World!" åˆ†æä¸º "hello" å’Œ "world"ã€‚
> * **Whitespace Analyzerï¼ˆç©ºæ ¼åˆ†æå™¨ï¼‰** ï¼šç©ºæ ¼åˆ†æå™¨æ ¹æ®ç©ºæ ¼å­—ç¬¦å°†æ–‡æœ¬åˆ†å‰²ä¸ºè¯æ±‡å•å…ƒã€‚å®ƒä¿ç•™ç©ºæ ¼å’Œæ ‡ç‚¹ç¬¦å·ï¼Œä¸åšå¤§å°å†™è½¬æ¢ã€‚ä¾‹å¦‚ï¼Œå°†è¾“å…¥æ–‡æœ¬ "Hello, World!" åˆ†æä¸º "Hello,"ã€"World!" å’Œ ""ï¼ˆç©ºå­—ç¬¦ï¼‰ã€‚
> * **Simple Analyzerï¼ˆç®€å•åˆ†æå™¨ï¼‰** ï¼šç®€å•åˆ†æå™¨æ ¹æ®éå­—æ¯å­—ç¬¦å°†æ–‡æœ¬åˆ†å‰²ä¸ºè¯æ±‡å•å…ƒï¼Œå¹¶å°†è¯æ±‡å•å…ƒè½¬æ¢ä¸ºå°å†™å½¢å¼ã€‚å®ƒä¸å¤„ç†åœç”¨è¯å’Œè¯å¹²æå–ã€‚ä¾‹å¦‚ï¼Œå°†è¾“å…¥æ–‡æœ¬ "Quick brown fox" åˆ†æä¸º "quick"ã€"brown" å’Œ "fox"ã€‚
> * **Keyword Analyzerï¼ˆå…³é”®å­—åˆ†æå™¨ï¼‰** ï¼šå…³é”®å­—åˆ†æå™¨å°†æ•´ä¸ªè¾“å…¥ä½œä¸ºå•ä¸ªè¯æ±‡å•å…ƒï¼Œä¸è¿›è¡Œåˆ†è¯ã€‚å®ƒé€šå¸¸ç”¨äºä¸éœ€è¦å¯¹è¾“å…¥è¿›è¡Œåˆ†è¯çš„åœºæ™¯ï¼Œå¦‚ç²¾ç¡®åŒ¹é…ã€‚
> * **Language-specific Analyzersï¼ˆç‰¹å®šè¯­è¨€åˆ†æå™¨ï¼‰** ï¼šElasticsearch è¿˜æä¾›äº†é’ˆå¯¹ç‰¹å®šè¯­è¨€çš„åˆ†æå™¨ï¼Œå¦‚è‹±è¯­ï¼ˆEnglish Analyzerï¼‰ã€æ³•è¯­ï¼ˆFrench Analyzerï¼‰ã€å¾·è¯­ï¼ˆGerman Analyzerï¼‰ç­‰ã€‚è¿™äº›åˆ†æå™¨æ ¹æ®ç‰¹å®šçš„è¯­è¨€è§„åˆ™å’Œè¯­æ³•è¿›è¡Œåˆ†è¯ã€åœç”¨è¯è¿‡æ»¤ã€è¯å¹²æå–ç­‰å¤„ç†ã€‚



# **åˆ†è¯å™¨ï¼šæ–‡å­—åŠ å·¥å‚çš„ã€Œæ™ºèƒ½æ–‡æœ¬å¤„ç†æœºã€ğŸ­ğŸ“**

æƒ³è±¡æ•°å­—æ‘æœ‰ä¸€å®¶ç¥å¥‡çš„**æ–‡å­—åŠ å·¥å‚**ï¼Œä¸“é—¨å¤„ç†å„ç§æ–‡æœ¬åŸææ–™ã€‚å·¥å‚é‡Œæœ‰ä¸åŒå‹å·çš„**æ–‡æœ¬å¤„ç†æœºï¼ˆåˆ†è¯å™¨ï¼‰**ï¼Œæ¯ç§æœºå™¨éƒ½æœ‰ç‹¬ç‰¹çš„åŠ å·¥æ–¹å¼ï¼ä»Šå¤©æˆ‘ä»¬å°±æ¥å‚è§‚è¿™å®¶å·¥å‚ï¼Œçœ‹çœ‹å¦‚ä½•ä¸ºä¸åŒäº§å“çº¿é€‰æ‹©åˆé€‚çš„æœºå™¨ã€‚

---

## **æ•…äº‹ï¼šæ–‡å­—åŠ å·¥å‚çš„ç”Ÿäº§çº¿é…ç½®**

### **1. ç”Ÿäº§çº¿è®¾ç½®å…¬å¼ï¼ˆæ˜ å°„è¯­æ³•ï¼‰**
```json
PUT {index}  // åˆ›å»ºæ–°å·¥å‚
{
  "mappings": {
    "properties": {
      "title": {              // äº§å“çº¿åç§°
        "type": "text",       // ç”Ÿäº§æ–‡æœ¬äº§å“
        "analyzer": "{analyzer}"  // é€‰æ‹©å¤„ç†æœºå™¨å‹å·
      }
    }
  }
}
```

**å®é™…å»ºå‚ç¤ºä¾‹ï¼š**
```json
PUT book_factory  // åˆ›å»ºä¹¦ç±åŠ å·¥å‚
{
  "mappings": {
    "properties": {
      "book_title": {        // ä¹¦ç±æ ‡é¢˜ç”Ÿäº§çº¿
        "type": "text",
        "analyzer": "standard"  // å®‰è£…æ ‡å‡†å¤„ç†æœº
      }
    }
  }
}
```

---

## **äº”å¤§ä¸»åŠ›å¤„ç†æœºå‹å·**

### **1. æ ‡å‡†å¤„ç†æœºï¼ˆStandard Analyzerï¼‰ğŸ†**
**å·¥å‚å®šä½ï¼š** å…¨èƒ½å‹ä¸»åŠ›è®¾å¤‡ï¼Œ**é»˜è®¤å®‰è£…**åœ¨æ‰€æœ‰ç”Ÿäº§çº¿ï¼

**åŠ å·¥ç‰¹ç‚¹ï¼š**
- ğŸ§¼ **æ¸…æ´å»æ‚**ï¼šè‡ªåŠ¨å»é™¤æ ‡ç‚¹ç¬¦å·
- ğŸ”„ **è§„æ ¼ç»Ÿä¸€**ï¼šæ‰€æœ‰æ–‡æœ¬è½¬ä¸ºå°å†™
- ğŸ”ª **æ™ºèƒ½åˆ†å‰²**ï¼šæŒ‰å•è¯è¾¹ç•Œåˆ‡åˆ†

**åŠ å·¥æ¼”ç¤ºï¼š**
```json
// åŸæ–™æŠ•å…¥
"Hello, World! ä½ å¥½ä¸–ç•Œ"

// åŠ å·¥æˆå“
["hello", "world", "ä½ ", "å¥½", "ä¸–", "ç•Œ"]
```

**é€‚ç”¨äº§å“çº¿ï¼š**
- å›½é™…æ–‡æ¡£ã€å¤šè¯­è¨€å†…å®¹
- ä¸çŸ¥é“é€‰ä»€ä¹ˆæ—¶çš„å®‰å…¨é€‰æ‹©

---

### **2. ç©ºæ ¼åˆ†å‰²æœºï¼ˆWhitespace Analyzerï¼‰âœ‚ï¸**
**å·¥å‚å®šä½ï¼š** ç®€å•ç²—æš´çš„åŸºç¡€è®¾å¤‡

**åŠ å·¥ç‰¹ç‚¹ï¼š**
- âš¡ **æç®€æ“ä½œ**ï¼šåªè®¤ç©ºæ ¼ï¼Œå…¶ä»–ä¸€å¾‹ä¸ç®¡
- ğŸ¯ **ä¿ç•™åŸè²Œ**ï¼šä¸æ”¹å˜å¤§å°å†™ï¼Œä¸è¿‡æ»¤æ ‡ç‚¹
- ğŸš€ **é«˜é€Ÿè¿è¡Œ**ï¼šå¤„ç†é€Ÿåº¦æœ€å¿«

**åŠ å·¥æ¼”ç¤ºï¼š**
```json
// åŸæ–™æŠ•å…¥
"Hello, World! 2023å¹´"

// åŠ å·¥æˆå“
["Hello,", "World!", "2023å¹´"]  // æ ‡ç‚¹åŸæ ·ä¿ç•™
```

**é€‚ç”¨äº§å“çº¿ï¼š**
- ä»£ç æ–‡ä»¶ã€æŠ€æœ¯æ–‡æ¡£
- éœ€è¦ä¿ç•™ç‰¹æ®Šç¬¦å·çš„åœºæ™¯

---

### **3. ç®€æ˜“å¤„ç†æœºï¼ˆSimple Analyzerï¼‰ğŸ“¦**
**å·¥å‚å®šä½ï¼š** å…¥é—¨çº§ç»æµè®¾å¤‡

**åŠ å·¥ç‰¹ç‚¹ï¼š**
- ğŸ”¤ **å­—æ¯ä¼˜å…ˆ**ï¼šé‡åˆ°éå­—æ¯å°±åˆ‡ä¸€åˆ€
- ğŸ”„ **åŸºç¡€å¤„ç†**ï¼šç»Ÿä¸€è½¬å°å†™
- ğŸš« **åŠŸèƒ½ç²¾ç®€**ï¼šä¸è¿‡æ»¤åœç”¨è¯ï¼Œä¸æå–è¯å¹²

**åŠ å·¥æ¼”ç¤ºï¼š**
```json
// åŸæ–™æŠ•å…¥
"Quick brown-fox jumps"

// åŠ å·¥æˆå“
["quick", "brown", "fox", "jumps"]  // è¿å­—ç¬¦å¤„åˆ‡æ–­
```

**é€‚ç”¨äº§å“çº¿ï¼š**
- ç®€å•è‹±æ–‡å†…å®¹
- é¢„ç®—æœ‰é™çš„åŠ å·¥éœ€æ±‚

---

### **4. æ•´è£…æ‰“åŒ…æœºï¼ˆKeyword Analyzerï¼‰ğŸ“**
**å·¥å‚å®šä½ï¼š** åŸè£…ä¿é²œè®¾å¤‡

**åŠ å·¥ç‰¹ç‚¹ï¼š**
- ğŸ“¦ **åŸå°ä¸åŠ¨**ï¼šå®Œå…¨ä¸åˆ‡å‰²ï¼Œæ•´æ®µæ–‡æœ¬ä½œä¸ºä¸€ä¸ªå•å…ƒ
- ğŸ¯ **ç²¾ç¡®åŒ¹é…**ï¼šæœç´¢æ—¶å¿…é¡»å®Œå…¨ä¸€è‡´
- ğŸ’¾ **èŠ‚çœç©ºé—´**ï¼šä¸å»ºç´¢å¼•ï¼Œå­˜å‚¨ç´§å‡‘

**åŠ å·¥æ¼”ç¤ºï¼š**
```json
// åŸæ–™æŠ•å…¥
"iPhone14 Pro Max 256GB"

// åŠ å·¥æˆå“
["iPhone14 Pro Max 256GB"]  // å®Œæ•´ä¿ç•™ï¼
```

**é€‚ç”¨äº§å“çº¿ï¼š**
- äº§å“å‹å·ã€IDç¼–å·
- ç”µè¯å·ç ã€é‚®æ”¿ç¼–ç 
- éœ€è¦ç²¾ç¡®åŒ¹é…çš„å­—æ®µ

---

### **5. æ¯è¯­ä¸“å®¶æœºï¼ˆLanguage-specific Analyzersï¼‰ğŸŒ**
**å·¥å‚å®šä½ï¼š** å¤–è¯­ä¸“ä¸šè®¾å¤‡ï¼ŒæŒ‰è¯­ç§åˆ†ä¸åŒå‹å·

**ä¸“å®¶å›¢é˜Ÿï¼š**
- ğŸ‡¬ğŸ‡§ **è‹±è¯­ä¸“å®¶**ï¼šæ™ºèƒ½å¤„ç†æ—¶æ€ã€å•å¤æ•°
- ğŸ‡«ğŸ‡· **æ³•è¯­ä¸“å®¶**ï¼šå¤„ç†æ³•è¯­ç‰¹æ®Šå­—ç¬¦
- ğŸ‡©ğŸ‡ª **å¾·è¯­ä¸“å®¶**ï¼šå¤„ç†å¤åˆè¯æ‹†åˆ†
- ğŸ‡¨ğŸ‡³ **ä¸­æ–‡ä¸“å®¶**ï¼šæ™ºèƒ½åˆ†è¯ï¼ˆéœ€è¦å®‰è£…IKæ’ä»¶ï¼‰

**è‹±è¯­ä¸“å®¶æœºæ¼”ç¤ºï¼š**
```json
// åŸæ–™æŠ•å…¥
"Running jumps happily"

// åŠ å·¥æˆå“
["run", "jump", "happily"]  // è¯å¹²æå–+æ—¶æ€å¤„ç†
```

**é€‚ç”¨äº§å“çº¿ï¼š**
- ç‰¹å®šè¯­è¨€çš„å†…å®¹åº“
- éœ€è¦é«˜çº§è¯­è¨€å¤„ç†çš„åœºæ™¯

---

## **å·¥å‚å®æˆ˜ï¼šä¸ºä¸åŒäº§å“çº¿é€‰é…æœºå™¨**

### **åœºæ™¯1ï¼šå›½é™…æ–°é—»ç½‘ç«™**
```json
PUT news_factory
{
  "mappings": {
    "properties": {
      "title": {
        "type": "text",
        "analyzer": "standard"  // æ ‡å‡†æœºå¤„ç†å¤šè¯­è¨€æ ‡é¢˜
      },
      "author_id": {
        "type": "text", 
        "analyzer": "keyword"   // æ•´è£…æœºä¿è¯ä½œè€…IDç²¾ç¡®åŒ¹é…
      }
    }
  }
}
```

### **åœºæ™¯2ï¼šä¸­æ–‡å°è¯´åº“**
```json
PUT novel_factory  
{
  "mappings": {
    "properties": {
      "content": {
        "type": "text",
        "analyzer": "ik_smart"  // ä¸­æ–‡ä¸“å®¶æœºï¼ˆéœ€å®‰è£…IKæ’ä»¶ï¼‰
      }
    }
  }
}
```

### **åœºæ™¯3ï¼šæŠ€æœ¯æ–‡æ¡£åº“**
```json
PUT code_factory
{
  "mappings": {
    "properties": {
      "code_snippet": {
        "type": "text",
        "analyzer": "whitespace"  // ç©ºæ ¼æœºä¿ç•™ä»£ç æ ¼å¼
      }
    }
  }
}
```

---

## **é€‰æ‹©æœºå™¨çš„é»„é‡‘æ³•åˆ™**

### **å†³ç­–æµç¨‹å›¾**
```
æ–‡æœ¬å†…å®¹ â†’ æ˜¯å¦éœ€è¦ç²¾ç¡®åŒ¹é…ï¼Ÿ â†’ æ˜¯ â†’ é€‰æ‹©Keywordæ•´è£…æœº
                â†“å¦
         â†’ æ˜¯å¦æ˜¯ä¸­æ–‡ï¼Ÿ â†’ æ˜¯ â†’ é€‰æ‹©IKä¸­æ–‡æœº
                â†“å¦  
         â†’ æ˜¯å¦éœ€è¦ä¿ç•™ç‰¹æ®Šç¬¦å·ï¼Ÿ â†’ æ˜¯ â†’ é€‰æ‹©Whitespaceç©ºæ ¼æœº
                â†“å¦
         â†’ æ˜¯å¦æ˜¯ç®€å•è‹±æ–‡ï¼Ÿ â†’ æ˜¯ â†’ é€‰æ‹©Simpleç®€æ˜“æœº  
                â†“å¦
         â†’ é€‰æ‹©Standardæ ‡å‡†æœºï¼ˆä¸‡èƒ½é€‰æ‹©ï¼‰
```

### **è®°å¿†å£è¯€**
**æ–‡æœ¬åŠ å·¥äº”è™å°†ï¼š**
- **æ ‡å‡†æœº**ï¼šä¸‡èƒ½é€‰æ‰‹ï¼Œé»˜è®¤é¦–é€‰ ğŸ†
- **ç©ºæ ¼æœº**ï¼šç¬¦å·ä¿ç•™ï¼Œä»£ç ä¸“ç”¨ âœ‚ï¸  
- **ç®€æ˜“æœº**ï¼šè‹±æ–‡ç®€å•ï¼Œç»æµå®æƒ  ğŸ“¦
- **æ•´è£…æœº**ï¼šç²¾ç¡®åŒ¹é…ï¼ŒåŸæ ·ä¿é²œ ğŸ“
- **ä¸“å®¶æœº**ï¼šæ¯è¯­å¤„ç†ï¼Œä¸“ä¸šç²¾å‡† ğŸŒ

**é€‰å‹ä¸‰é—®ï¼š**
> 1ï¸âƒ£ è¦ç²¾ç¡®åŒ¹é…å—ï¼Ÿ â†’ é€‰Keyword  
> 2ï¸âƒ£ æ˜¯ä¸­æ–‡å†…å®¹å—ï¼Ÿ â†’ é€‰IKä¸­æ–‡åˆ†æå™¨  
> 3ï¸âƒ£ è¦ä¿ç•™ç¬¦å·å—ï¼Ÿ â†’ é€‰Whitespace  
> 4ï¸âƒ£ å…¶ä»–æƒ…å†µ â†’ é€‰Standardæœ€å®‰å…¨  

---

## **ç‰¹åˆ«æé†’ï¼šä¸­æ–‡å¤„ç†éœ€è¦ç‰¹æ®Šè£…å¤‡**

Elasticsearché»˜è®¤æ²¡æœ‰ä¸­æ–‡ä¸“å®¶æœºï¼Œéœ€è¦**å®‰è£…IKæ’ä»¶**ï¼š
```bash
# åœ¨ESå®¹å™¨ä¸­å®‰è£…IKä¸­æ–‡å¤„ç†æœº
elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.14.0/elasticsearch-analysis-ik-7.14.0.zip
```

**å®‰è£…åå³å¯ä½¿ç”¨ï¼š**
```json
"analyzer": "ik_smart"  // æ™ºèƒ½ä¸­æ–‡åˆ†è¯
"analyzer": "ik_max_word"  // æœ€ç»†ç²’åº¦ä¸­æ–‡åˆ†è¯
```

è®°ä½è¿™ä¸ªæ–‡å­—åŠ å·¥å‚çš„æ¯”å–»ï¼Œä¸‹æ¬¡é…ç½®æ˜ å°„æ—¶å°±èƒ½è½»æ¾é€‰å‡ºæœ€é€‚åˆçš„åˆ†è¯å™¨äº†ï¼ğŸ­ğŸ¯