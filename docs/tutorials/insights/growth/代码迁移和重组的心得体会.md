## 故事背景

> 在AI时代下如何就是对代码进行增加模块化功能。当前存在一大目前的痛点现象：不是写代码很难，也不是梳理业务需求的思路很难。难在就是如何将清晰的需求在之前代码实现上，对于即将要改动的代码是一个大致的理解，做了对应的修改之后。如何能串行流程。改动了部分功能之后，会出现一些奇怪的报错。但是通过人眼去查看。在高级编辑器中进行肉眼式搜索，会出现看了半天越看越晕。

![](https://shuyixiao.oss-cn-hangzhou.aliyuncs.com/BlogPicture/image-20260206154013620.png)

对于上述奇怪的报错，通过肉眼的方式进行排查效率很低，所以需要借用魔法的力量，在Codex的帮助下，直接获得到了完整的调用链路。



```mermaid
sequenceDiagram
    participant UI as 前端页面
    participant Auth as PlatformAuthServiceImpl
    participant AppCtl as AppInfo/AppSettings Controller
    participant AppSvc as AppInfo/AppSettings Service
    participant RagSvc as RagConfigLlmModelService
    participant Group as SelectGroupResp
    participant DB as MySQL
    participant Ex as GlobalExceptionAdvice

    UI->>Auth: /store/api/saas/app/checkPermission
    Auth->>AppCtl: 放行
    AppCtl->>AppSvc: checkAppPermission(appid)
    AppSvc->>DB: select app_info by appid
    DB-->>AppSvc: app记录
    AppSvc-->>UI: 权限结果(成功)

    par 并发请求
        UI->>Auth: /store/api/saas/app/queryByAppId
        Auth->>AppCtl: 放行
        AppCtl->>AppSvc: queryByAppId(appid)
        AppSvc->>DB: select app_info by appid+tenant
        DB-->>UI: 应用详情
    and
        UI->>Auth: /kl/api/saas/prompt/queryInfo
        Auth-->>UI: 放行并返回Prompt信息
    and
        UI->>Auth: /store/api/saas/settings/llm/groups
        Auth->>AppCtl: 放行
        AppCtl->>RagSvc: queryLLMGroups()
        RagSvc->>DB: select rag_config_llm_model
        DB-->>RagSvc: 41条模型
        RagSvc->>Group: SelectGroupResp.of(models)
        Group->>Group: ModelProviders.valueOf(\"Kimi\")
        Group-->>Ex: IllegalArgumentException
        Ex-->>UI: 错误响应
    end

    UI->>Auth: /store/api/saas/settings/queryById
    Auth->>AppCtl: 放行
    AppCtl->>AppSvc: querySettingByAppId(appid)
    AppSvc->>RagSvc: 通过 availableModel 间接取分组
    RagSvc->>Group: SelectGroupResp.of(models)
    Group->>Group: ModelProviders.valueOf(\"Kimi\")
    Group-->>Ex: IllegalArgumentException
    Ex-->>UI: 错误响应
```

## GLM4.7分析报错，解决问题使用CodeX

## 代码书写不顺先就是AI上实现功能，利用ai进行重构

##  使用AI的长上下文能力对于接口代码进行梳理调用链路，便于实现对于现有臃肿复杂代码功能迭代重构，查看模型梳理的代码逻辑美人鱼图还是会出现就是代码逻辑梳理不清晰，继续询问。

经过这个流程，我也发现一个规律，对于Java代码来说梳理业务逻辑其实比起关注get、set方法。更加应该关注一下if-else的逻辑。

![](https://shuyixiao.oss-cn-hangzhou.aliyuncs.com/BlogPicture/image-20260209112455031.png)

## 代码看不清晰结合前端请求参数并配合自研https://www.strloom.com/网站进行

## AI写完代码真的需要用AI进行审核和验证，哪怕最强的模型也存在疏漏